<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virtual Museum</title>
  <meta name="description" content="The bois' museum">

  <!-- CSS stylesheets -->
  <link rel="stylesheet" href="css/user-gesture.css">
  <link rel="stylesheet" href="css/user-interface.css">

  <!-- Library imports -->
  <script src="/js/libraries/aframe.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <!-- Physics -->
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>

  <!-- Environment engine-->
  <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>

  <!-- Custom components imports -->
  <script type="module" src="/js/components/player.js"></script>
  <script src="/js/components/player-controller.js"></script>
  <script src="/js/components/game-controller.js"></script>
  <script src="/js/components/other-player.js"></script>
  <script src="/js/components/exhibit.js"></script>
  <script src="/js/components/exhibit-part.js"></script>

  <!-- Local imports -->
  <script src="/js/sockets/client-socket.js"></script>
</head>

<body>
  <!-- GUI -->
  <div id="user-interface">
    <!-- "Searching For" Box -->
    <div id="searchingForGrp">
      <div id="searchingForBox" class="uiBox"><img class="propImage" src="../assets/images/Stereopsis/Steropsis_FULLsm.png"></div>
      <div id="searchingForText" class="uiText">
        <h3>Searching for:</h3>
        <h4 id="itemName">Stereopsis</h4>
      </div>
    </div>

    <!-- Hint box -->
    <div id="hintGrp">
      <div id="hintText" class="uiText">
        <h3>Hint:</h3>
        <h4 id="hint">Have you checked the exhibit?</h4>
      </div>
    </div>

    <!-- Inventory boxes -->
    <div id="inventoryGrp">
        <div id="inventoryBox1" class="uiBox"><img class="propImage" src="../assets/images/Stereopsis/Stereopsis_P1.png"></div>
        <div id="inventoryBox2" class="uiBox"><img class="propImage" src="../assets/images/Stereopsis/Stereopsis_P2.png"></div>
        <div id="inventoryBox3" class="uiBox"><img class="propImage" src="../assets/images/Stereopsis/Stereopsis_P3.png"></div>
    </div>

    <!-- Messages -->
    <!--<div id="messageGrp">
      <h3 id="messageBox">Player joined</h3>
    </div>-->
  </div>
  <!-- End of GUI -->

  <!-- Scene -->
  <a-scene physics="debug: false">
    <!-- <div id="ui"></div> -->
    <div id="text"></div>

    <a-assets timeout="10000">
      <a-asset-item id="hmd-gltf" src="assets/scene.gltf"></a-asset-item>

      <!-- Environment assets -->
      <a-asset-item id="museum-floor-1" src="assets/environment/Floor/floor1.obj"></a-asset-item>
      <a-asset-item id="museum-floor-2" src="assets/environment/Floor/floor2.obj"></a-asset-item>
      <a-asset-item id="museum-floor-ramp-1" src="assets/environment/Floor/ramp1.obj"></a-asset-item>
      <a-asset-item id="museum-floor-ramp-2" src="assets/environment/Floor/ramp2.obj"></a-asset-item>
      <a-asset-item id="env-walls" src="assets/environment/Environment_blockout_walls.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-pillar1" src="assets/environment/Environment_moulding_pillar1.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-pillar2" src="assets/environment/Environment_moulding_pillar2.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-exterior-walls" src="assets/environment/Environment_moulding_exteriorWalls.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-interior-walls" src="assets/environment/Environment_moulding_interiorWalls.obj"></a-asset-item>
    </a-assets>

    <!-- GAME CONTROLLER (manages the 'game') -->
    <a-entity game-controller></a-entity>

    <!-- PLAYERS CONTROLLER (for viewing other players) -->
    <a-entity players-controller></a-entity>

    <!-- LIGHTS -->
    <a-entity id="lights">
      <a-entity light="type: directional; intensity: 0.33" position="-20 20 20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="20 20 -20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="20 20 20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="-20 20 -20"></a-entity>
    </a-entity>

    <a-entity id="camera"
              position="-16 2 0.8"
              player camera wasd-controls="acceleration: 20"
              look-controls="pointerLockEnabled: false">

      <a-entity light="type: point; intensity: 0.25" rotation="90 0 0"></a-entity>
      <a-entity class="geo"></a-entity>
      <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects: .interactive"></a-entity>
      <a-cursor></a-cursor>
    </a-entity>

    <!-- Exhibit parts -->
    <a-entity id="exhibitParts">
      <a-entity exhibit-part="partId: 1; relatedExhibitId: 1;"
                position="-10.1 0.6 -0.9"></a-entity>
      <a-entity exhibit-part="partId: 2; relatedExhibitId: 1;"
                position="-4 0.5 -11.7"></a-entity>
      <a-entity exhibit-part="partId: 3; relatedExhibitId: 1;"
                position="5.3 4.8 -0.3"></a-entity>
    </a-entity>

    <a-entity exhibit="exhibitId: 1" id="exhibitone" position="0 0 -5">

      <a-entity gltf-model="#hmd-gltf" class="interactive" position="0 1.65 0"
                scale="0.06 0.06 0.06" rotation="0 25 0" shadow="cast: true; receive: true">
      </a-entity>

      <a-entity id="pedestalPillar" position="0 0.5 0" rotation="0 0 0" scale="1 1 1"
        geometry="primitive:cylinder; height:2; radius: 0.5;" material="color:red"
        shadow="cast: true; receive: true">
      </a-entity>

      <a-dodecahedron position="0 -1.4 0" rotation="-32.5 1.5 0" material="color:black"
        radius="2" shadow="cast:true; receive:true;">
      </a-dodecahedron>

      <a-entity id="screens" visible="false" position="0 2.75 0">

      <a-entity id="screen-middle" position="0 0 0" rotation="0 0 0" scale="1.75 0.55 1"
        geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
        shadow="cast: true; receive: true">

        <p id="demo"></p>

        <a-entity id="screen-text" text="value:;" position="1.05 0 0.1" scale="3 3 3"></a-entity>

      </a-entity>

      <a-entity id="screen-right" position="0 0 0" rotation="0 0 0" scale="1.25 0.5 1"
        geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
        shadow="cast: true; receive: true">
      </a-entity>

      <a-entity id="screen-left" position="0 0 0" rotation="0 0 0" scale="1.25 0.5 1"
        geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
        shadow="cast: true; receive: true">
      </a-entity>

      </a-entity>

    </a-entity>

    <!-- Environment -->
    <a-obj-model static-body src="#museum-floor-1" mtl=""></a-obj-model>
    <a-obj-model static-body src="#museum-floor-2" mtl=""></a-obj-model>
    <a-obj-model static-body src="#museum-floor-ramp-1" mtl=""></a-obj-model>
    <a-obj-model static-body src="#museum-floor-ramp-2" mtl=""></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-mouldings-pillar1" mtl="#env-mouldings-pillar1"></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-mouldings-pillar2" mtl="#env-mouldings-pillar2"></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-walls" mtl="#env-walls"></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-mouldings" mtl="#env-mouldings"></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-mouldings-exterior-walls" mtl="#env-mouldings-exterior-walls"></a-obj-model>
    <a-obj-model static-body="shape: convex;" src="#env-mouldings-interior-walls" mtl="#env-mouldings-interior-walls"></a-obj-model>

    <a-entity environment="preset:starry;"></a-entity>

  </a-scene>
  <!-- End of scene -->

  <!-- Temporary message updater -->
  <script>
    /*let socket = io();
    socket.on('playerJoined', (data) => {
      document.querySelector('#messageBox').innerHTML = 'A new player has joined.';
    })
    socket.on('playerQuit', (data) => {
      document.querySelector('#messageBox').innerHTML = 'A player has quit.';
    })*/
  </script>
</body>
</html>
