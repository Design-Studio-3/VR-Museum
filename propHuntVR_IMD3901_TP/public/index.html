<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Virtual Museum</title>
  <meta name="description" content="The bois' museum">

  <!-- CSS stylesheets -->
  <link rel="stylesheet" href="css/user-gesture.css">

  <!-- Library imports -->
  <script src="/js/libraries/aframe.min.js"></script>
  <script src="/socket.io/socket.io.js"></script>

  <!-- Physics -->
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>

  <!-- Environment engine-->
  <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>

  <!-- Custom components imports -->
  <script type="module" src="/js/components/player.js"></script>
  <script type="module" src="/js/components/exhibit.js"></script>
  <script src="/js/components/player-controller.js"></script>
  <script src="/js/components/game-controller.js"></script>
  <script src="/js/components/other-player.js"></script>
  <script src="/js/components/exhibit-part.js"></script>

  <!-- Local imports -->
  <script src="/js/sockets/client-socket.js"></script>

</head>

<body>
  <a-scene physics="debug: true; gravity: -9.8;">
    <!-- <div id="ui"></div> -->
    <div id="text"></div>

    <a-assets timeout="10000">
      <!-- Player model -->
      <a-asset-item id="player-model" src="assets/models/Player/Player_full.gltf"></a-asset-item>

      <!-- Exhibit Items -->
      <a-asset-item id="hmd-gltf" src="assets/scene.gltf"></a-asset-item>
      <a-asset-item id="stereopsis-full-obj" src="assets/models/Stereopsis/Steropsis_FULLsm.obj"></a-asset-item>
      <!-- Stereopsis parts -->
      <a-asset-item id="stereopsis-part1-model" src="assets/models/Stereopsis/Part1/Stereopsis_p1.gltf"></a-asset-item>
      <a-asset-item id="stereopsis-part2-model" src="assets/models/Stereopsis/Part2/Stereopsis_p2.gltf"></a-asset-item>
      <a-asset-item id="stereopsis-part3-model" src="assets/models/Stereopsis/Part3/Stereopsis_p3.gltf"></a-asset-item>

      <!-- Environment assets -->
      <a-asset-item id="pedestal-model" src="assets/models/Pedestal/Pedestal.gltf"></a-asset-item>
      <a-asset-item id="env-floor" src="assets/environment/Environment_blockout_floor.obj"></a-asset-item>

      <a-asset-item id="env-walls" src="assets/environment/Environment_blockout_walls.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-pillar1" src="assets/environment/Environment_moulding_pillar1.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-pillar2" src="assets/environment/Environment_moulding_pillar2.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-exterior-walls" src="assets/environment/Environment_moulding_exteriorWalls.obj"></a-asset-item>
      <a-asset-item id="env-mouldings-interior-walls" src="assets/environment/Environment_moulding_interiorWalls.obj"></a-asset-item>
    </a-assets>

    <!-- GAME CONTROLLER (manages the 'game') -->
    <a-entity game-controller></a-entity>

    <!-- PLAYERS CONTROLLER (for viewing other players) -->
    <a-entity players-controller></a-entity>

    <!-- LIGHTS -->
    <a-entity id="lights">
      <a-entity light="type: directional; intensity: 0.33" position="-20 20 20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="20 20 -20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="20 20 20"></a-entity>
      <a-entity light="type: directional; intensity: 0.33" position="-20 20 -20"></a-entity>
    </a-entity>

    <a-entity id="rig" movement-controls kinematic-body player
              position="-16 2 0.8">
      <a-entity id="camera" camera position="0 2 0" look-controls></a-entity>
      <a-entity light="type: point; intensity: 0.25" rotation="90 0 0"></a-entity>
      <a-entity class="geo"></a-entity>
      <a-entity cursor="rayOrigin:mouse;" raycaster="far:20; interval:200; objects: .interactive"></a-entity>
    </a-entity>

    <!-- Exhibit parts -->
    <a-entity id="exhibitParts">
      <a-entity exhibit-part="partId: 1; relatedExhibitId: 1;"
                position="-10.1 0.6 -0.9"></a-entity>
      <a-entity exhibit-part="partId: 2; relatedExhibitId: 1;"
                position="-4 0.5 -11.7"></a-entity>
      <a-entity exhibit-part="partId: 3; relatedExhibitId: 1;"
                position="5.3 4.8 -0.3"></a-entity>
    </a-entity>

    <!-- Exhibits -->
    <a-entity>
      <a-entity exhibit="exhibitId: 1" id="exhibitone" position="0 0 -5">

        <!-- Stereopsis -->
        <a-obj-model id="stereoscope" scale="0.5 0.5 0.5"
                     src="#stereopsis-full-obj" position="0 0.65 0" rotation="0 0 0"
                     shadow="cast: true; receive: true"
                     visible="false">
        </a-obj-model>
        <a-entity gltf-model="#pedestal-model" static-body="shape: box" position="0 0.4 0"></a-entity>

        <a-dodecahedron position="0 -1.4 0" rotation="-32.5 1.5 0" material="color:black"
          radius="2" shadow="cast:true; receive:true;">
        </a-dodecahedron>

        <a-entity id="screens" visible="false" position="0 2.80 0">
          <a-entity id="screen-middle" position="0 0 0" rotation="0 0 0" scale="1.75 0.55 1"
          geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
          shadow="cast: true; receive: true">
            <p id="demo"></p>
          </a-entity>

          <a-entity id="screen-right" position="0 0 0" rotation="0 0 0" scale="1.25 0.4 1"
          geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
          shadow="cast: true; receive: true">
            <a-entity id="screen-right-text" position="0 0 0.01"
            geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/StereoText1.png; opacity:0.0; transparent: true; alphaTest: 0.5;">
            </a-entity>
          </a-entity>

          <a-entity id="screen-left" position="0 0 0" rotation="0 0 0" scale="1.25 0.4 1"
          geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/holo.png; opacity:0.0;"
          shadow="cast: true; receive: true">
            <a-entity id="screen-left-text" position="0 0 0.01"
            geometry="primitive:plane; height:2; radius: 0.5;" material="src: assets/StereoText1.png; opacity:0.0; transparent: true; alphaTest: 0.5;">
            </a-entity>
          </a-entity>
        </a-entity>
      </a-entity>
    </a-entity>

    <!-- Environment -->
    <a-obj-model src="#env-floor"></a-obj-model>

    <a-entity static-body="shape: box" geometry="primitive: box" scale="50 1 50" material="color: red" position="0 -0.55 0"></a-entity>
    <a-entity static-body="shape: convex" geometry="primitive: box" material="color: red" scale="5.130 1 4.280" position="8.489 0.266 -7.341" rotation="0 0 17.8"></a-entity>
    <a-entity static-body="shape: box" geometry="primitive: box" material="color: red" scale="16.410 1 10.830" position="18.941 0.999 -9.649"></a-entity>
    <a-entity static-body="shape: convex" geometry="primitive: box" material="color: red" scale="5.130 2 4.280" position="22.711 -0.296 -1.849" rotation="0 90 17.8"></a-entity>

    <a-obj-model src="#env-mouldings-pillar1" mtl="#env-mouldings-pillar1"></a-obj-model>
    <a-obj-model src="#env-mouldings-pillar2" mtl="#env-mouldings-pillar2"></a-obj-model>
    <a-obj-model src="#env-walls" mtl="#env-walls"></a-obj-model>
    <a-obj-model src="#env-mouldings" mtl="#env-mouldings"></a-obj-model>
    <a-obj-model src="#env-mouldings-exterior-walls" mtl="#env-mouldings-exterior-walls"></a-obj-model>
    <a-obj-model src="#env-mouldings-interior-walls" mtl="#env-mouldings-interior-walls"></a-obj-model>

    <a-entity environment="preset:starry;"></a-entity>

  </a-scene>
</body>
</html>
